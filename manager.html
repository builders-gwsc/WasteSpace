<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Griffin Waste – Manager</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- HEADER -->
  <header class="app-header">
    <img src="assets/logo.png" alt="Griffin Waste Logo" class="logo"/>
    <h1>Manager Portal</h1>
    <button id="logoutBtn" class="logout-btn">Logout</button>
  </header>

  <!-- MANAGER NAVIGATION -->
  <nav class="hub-nav">
    <button onclick="location.href='hub.html'" class="nav-btn">🏠 Hub</button>
    <button onclick="alert('Calendar coming soon!')" class="nav-btn">📅 Calendar</button>
    <button onclick="alert('PTO Requests coming soon!')" class="nav-btn">📝 PTO Requests</button>
  </nav>

  <!-- ASSIGNMENT FORM -->
  <section>
    <h2>Create Assignment</h2>
    <div class="form-row">
      <input id="customerName" placeholder="Customer Name" />
      <input id="jobAddress" placeholder="Job Address" />
      <select id="category">
        <option value="Dumpster">Dumpster</option>
        <option value="Porta-Jon">Porta-Jon</option>
      </select>
      <select id="task">
        <option value="Delivery">Delivery</option>
        <option value="Pickup">Pickup</option>
        <option value="Service">Service</option>
      </select>
      <select id="driverSelect">
        <option value="Anthony">Anthony</option>
        <option value="Brian Helms">Brian Helms</option>
      </select>
      <button id="assignBtn">Assign</button>
    </div>
  </section>

  <!-- ASSIGNMENTS -->
  <section>
    <h2>Assignments</h2>
    <ul id="assignmentList"></ul>
  </section>

  <script type="module">
    import { auth, db } from "./js/config.js";
    import { logout } from "./js/auth.js";
    import {
      collection, addDoc, query, onSnapshot
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", logout);

    // Assignment creation
    document.getElementById("assignBtn").addEventListener("click", async () => {
      const customer = document.getElementById("customerName").value;
      const address = document.getElementById("jobAddress").value;
      const category = document.getElementById("category").value;
      const task = document.getElementById("task").value;
      const driver = document.getElementById("driverSelect").value;

      if (!customer || !address) {
        alert("Customer and address required!");
        return;
      }

      await addDoc(collection(db, "assignments"), {
        customer, address, category, task, driver, status: "pending"
      });
    });

    // Live assignments
    const q = query(collection(db, "assignments"));
    onSnapshot(q, (snapshot) => {
      const assignmentList = document.getElementById("assignmentList");
      assignmentList.innerHTML = "";
      snapshot.forEach((doc) => {
        const d = doc.data();
        const li = document.createElement("li");
        li.textContent = `${d.customer} – ${d.task} (${d.category}) → ${d.driver} [${d.status}]`;
        assignmentList.appendChild(li);
      });
    });
  </script>
</body>
</html>
